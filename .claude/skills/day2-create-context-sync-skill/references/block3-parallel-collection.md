# Block 3: 병렬 수집 (Parallel Collection)

> **Phase A 시작 시 반드시 아래 형태로 출력한다:**
> ```
> 📖 공식 문서: https://docs.claude.com/en/docs/claude-code/sub-agents
> ```

## EXPLAIN

### Day 1 복습: Subagent와 Agent Teams

Day 1 Block 3-4에서 배운 **Subagent**를 기억하시나요?

- **Subagent** = 부하 직원. Claude가 다른 Claude를 불러서 독립된 공간에서 일을 시키고, 결과만 받는 것
- **Agent Teams** (Block 3-5) = 프로젝트 팀. 여러 Claude가 서로 소통하면서 협업하는 것

오늘은 이 Subagent를 **실전에 적용**합니다.

### "병렬 수집"이란?

여러 도구에서 **동시에** 정보를 가져오는 것입니다.

일상에서 비유하면:

| 방식 | 비유 | 소요 시간 |
|------|------|----------|
| **순차 수집** | 마트에서 혼자 장보기: 과일 코너 → 정육 코너 → 유제품 코너 순서대로 이동 | 30분 |
| **병렬 수집** | 가족 3명이 나눠서 장보기: 한 명은 과일, 한 명은 고기, 한 명은 우유 | 10분 |

Claude도 마찬가지입니다:

```
❌ 순차 수집 (느림)
  Slack 읽기 (30초) → Gmail 읽기 (30초) → Calendar 읽기 (30초)
  총 90초

✅ 병렬 수집 (빠름)
  Slack 읽기 (30초)  ─┐
  Gmail 읽기 (30초)   ├── 동시 실행
  Calendar 읽기 (30초) ─┘
  총 30초
```

### 어떻게 동시에 하나?

Claude는 **Task 도구**로 subagent를 여러 개 동시에 호출합니다.

```
┌─ 메인 Claude ─────────────────────────────────────┐
│                                                   │
│  "싱크 실행해줘" 요청 받음                          │
│                                                   │
│  ┌─ Subagent 1 ─┐  ┌─ Subagent 2 ─┐  ┌─ Subagent 3 ─┐
│  │ Slack 수집    │  │ Gmail 수집    │  │ Calendar 수집  │
│  │ 담당: 채널 3개 │  │ 담당: 이메일   │  │ 담당: 일정     │
│  └──────┬───────┘  └──────┬───────┘  └──────┬────────┘
│         │                │                 │
│         ▼                ▼                 ▼
│      결과 전달         결과 전달          결과 전달
│                                                   │
│  ──▶ 결과 모아서 통합 문서 작성                     │
└───────────────────────────────────────────────────┘
```

핵심 포인트:
- 각 subagent는 **하나의 소스(도구)만 담당**합니다
- 서로의 결과를 기다리지 않고 **독립적으로** 수집합니다
- 모든 subagent가 끝나면, 메인 Claude가 **결과를 모아서 통합**합니다

### Block 0에서 만든 스킬과의 연결

Block 0에서 생성한 스킬의 "실행 흐름 → 1단계: 병렬 수집" 섹션이 바로 이 구조입니다.
스킬 파일에 이미 아래와 같은 내용이 적혀 있습니다:

```
수집 시작
  ├── [소스 1] Slack 채널 메시지 수집      ─┐
  ├── [소스 2] Gmail 이메일 수집            ├── 병렬 실행
  ├── [소스 3] Google Calendar 일정 수집    │
  └── [소스 4] Notion 태스크 수집           ─┘
수집 완료
```

이번 블록에서는 이 병렬 수집을 **실제로 실행**해봅니다.

## EXECUTE

### 실행 안내

Claude에게 아래와 같이 요청하여 Block 0에서 생성한 스킬의 병렬 수집을 실행합니다:

```
내 context sync 스킬의 병렬 수집을 실행해줘
```

Claude가 하는 일:

1. 사용자의 `.claude/skills/my-context-sync/SKILL.md`를 읽어서 소스 목록을 확인합니다
2. 각 소스별로 subagent(Task 도구)를 **동시에** 호출합니다
3. 사용자의 화면에는 각 subagent의 진행 상황이 표시됩니다:
   ```
   [Slack 수집] 진행 중...
   [Gmail 수집] 진행 중...
   [Calendar 수집] 진행 중...
   ```
4. 수집이 완료되면 소스별로 결과를 정리하여 보여줍니다

### 수집 결과 리포트

수집이 끝나면 **성공한 소스**와 **실패한 소스**를 구분하여 보여줍니다:

```
수집 결과:
  Slack: 3개 채널, 47개 메시지 (성공 ✅)
  Gmail: 12개 이메일 (성공 ✅)
  Calendar: 수집 실패 ❌ (원인: 인증 토큰 만료)
  Notion: 15개 태스크 (성공 ✅)

성공: 3/4 소스
실패: 1/4 소스 (다음 블록에서 재시도합니다)
```

> 실패한 소스가 있어도 괜찮습니다! 다음 Block 4에서 실패 원인을 분석하고 재시도합니다.

### 수집된 데이터 미리보기

각 소스별로 수집된 내용의 요약을 확인합니다:

```
[Slack 요약]
  - #general: 주간 회의 시간 변경 공지
  - #project-updates: v2.0 배포일 확정
  - 총 47개 메시지 중 중요 5개 추출

[Gmail 요약]
  - 안 읽은 이메일 5개
  - 회신 필요: 2개
  - 총 12개 이메일 중 액션 필요 3개
```

이 결과가 Block 4(결과 검증)와 Block 5(출력 포맷)에서 활용됩니다.

## QUIZ

```json
AskUserQuestion({
  "questions": [
    {
      "question": "\"병렬 수집\"의 가장 큰 장점은 무엇인가요?",
      "header": "Quiz 3-1",
      "options": [
        {"label": "여러 소스를 동시에 수집하여 시간을 절약한다", "description": "각 subagent가 독립적으로 동시 실행"},
        {"label": "데이터를 더 정확하게 수집한다", "description": "정확도는 병렬/순차와 무관"},
        {"label": "하나가 실패하면 전체가 멈춘다", "description": "오히려 독립 실행이라 다른 소스에 영향 없음"}
      ],
      "multiSelect": false
    },
    {
      "question": "수집이 실패한 소스는 어떻게 처리하나요?",
      "header": "Quiz 3-2",
      "options": [
        {"label": "실패 원인과 함께 리포트하고, 다음 단계에서 재시도한다", "description": "Block 4에서 실패 원인 분석 + 재시도"},
        {"label": "무시하고 넘어간다", "description": "실패한 소스도 중요한 정보일 수 있음"},
        {"label": "전체 수집을 처음부터 다시 한다", "description": "성공한 소스까지 다시 할 필요 없음"}
      ],
      "multiSelect": false
    }
  ]
})
```

정답: 3-1은 1번, 3-2는 1번.
